name: validate_semver

on:
  pull_request:
    branches: [ dev ]

        
jobs:
  # validate the PR title
  validate_semver:
    runs-on: ubuntu-latest
    steps:
    - uses: deepakputhraya/action-pr-title@master
      with:
        allowed_prefixes: '(bugfix),(balance),(rework),(feature),(major)' # title should start with the given prefix
        prefix_case_sensitive: false # title prefix are case insensitive
  comment_bad_pr:
    runs-on: ubuntu-latest
    needs: [validate_semver]
    if: always() && (needs.validate_semver.result == 'failure')
    steps:
      - uses: actions/github-script@v5
        with:
          github-token: ${{secrets.GITHUB_TOKEN}}
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'This PR has no versioning info! Reopen this PR with a title that starts with one of the following options:\n
                (bugfix), (balance), (rework), (feature), or (major). \n
                Example title:
                  (bugfix) Fix falling through the floor on training reset'
            })
